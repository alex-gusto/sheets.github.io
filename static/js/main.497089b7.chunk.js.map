{"version":3,"sources":["components/NavBar.js","db/dataService.js","helpers/perfomance.js","views/Handsontable.js","helpers/flat-data.js","views/SpreadJS.js","views/ZingGrid.js","views/WijmoGrid.js","App.js","index.js"],"names":["NavBar","className","to","exact","path","Component","this","data","Phases","Costs","fn","ts","performance","now","err","console","log","toFixed","SpreadSheetsCon","props","initTable","hot","Handsontable","tableRef","current","dataService","getPhases","nestedRows","colHeaders","rowHeaders","autoRowSize","stretchH","height","width","persistentState","nestedHeaders","label","colspan","columns","type","numericFormat","pattern","allowEmpty","correctFormat","contextMenu","bindRowsWithHeaders","manualRowMove","updateSettings","cells","row","col","prop","classes","readOnly","isTotal","instance","getDataAtRowProp","visualRow","push","start","overriddenStart","lockTimestamp","Date","join","createRef","state","time","setState","document","querySelector","remove","style","color","ref","overflow","flex","fontSize","createFlatter","globalIndex","flatData","newData","groups","forEach","__children","index","count","length","GC","window","columnToLetter","column","temp","letter","String","fromCharCode","SpreadJS","initSpread","spread","Spread","Sheets","Workbook","sheetCount","options","tabStripVisible","tabNavigationVisible","tabEditable","newTabVisible","sheet","getActiveSheet","spreadNS","suspendPaint","isProtected","autoGenerateColumns","setDataSource","setRowCount","SheetArea","colHeader","addSpan","setValue","bindColumn","name","displayName","formatter","size","setColumnCount","Style","backColor","cellPadding","totalRow","getRowCount","addRows","viewport","setStyle","columnsCount","getColumnCount","groupsIndex","map","i","getCell","borderLeft","LineBorder","LineStyle","thin","borderRight","borderTop","borderBottom","columnLetter","startRow","endRow","sumFormula","setFormula","CellRange","locked","rowOutlines","group","expand","direction","Outlines","OutlineDirection","backward","autoFitColumn","resumePaint","setTimeout","assignDataToNestedGrid","cellRef","recordRef","setData","JSON","stringify","ZingGridView","ZingGrid","tabelEl","header","editor","layout","loading","loadByScroll","addEventListener","e","getRowLevel","wjGrid","isGroupRow","level","getParentNode","parentRow","rowLevel","grid","rows","CostTableView","gridRef","costs","getCosts","filter","initialWorkerGrid","workerGrid","formatItem","addHandler","panel","rowData","colData","dataItem","test","binding","hasChildren","itemFormatter","r","c","cell","cellType","ColumnHeader","onCellEditEnding","updateGridStyles","cssClass","isReadOnly","onFilter","value","target","toLowerCase","onMenuItemClicked","selectedValue","cmd","addRow","rowIndex","selection","code","days","populatedDays","refresh","removeRow","parentRowData","childIndex","findIndex","child","splice","collapseAll","collapseGroupsToLevel","expandAll","maxGroupLevel","onDraggedRow","exportExcel","book","FlexGridXlsxConverter","save","includeColumnHeaders","includeRowHeaders","sheets","saveAsync","rowAdded","deletedRow","deletingRow","model","lockDate","currencies","get","priorCol","beforeOnhire","key","afterOffhireCol","afterOffhire","columnsRight","title","eachPhaseDay","day","date","phase","serial","renderer","td","cellProperties","placeholderKey","replace","placeholder","FlexGrid","childItemsPath","selectionMode","dataMap","itemsSource","loadedRows","s","filterString","keysToSearch","collectResults","acc","cost","res","v","some","includes","costCopy","Object","assign","children","reduce","search","allowResizing","marginBottom","onChange","frozenColumns","allowSorting","allowDragging","allowAddNew","initialized","cellEditEnding","draggedRow","minWidth","format","contextMenuOf","selectedValuePath","dropDownCssClass","itemClicked","Sample","WijmoGrid","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.497089b7.chunk.js","sourcesContent":["import React, { Component } from 'react';\r\nimport './NavBar.css'\r\nimport { Link, Route, Switch } from 'react-router-dom'\r\n\r\nclass NavBar extends Component {\r\n    render() {\r\n        return (\r\n            <div className=\"navigationBar\">\r\n                <h3>Navigation</h3>\r\n                <nav className=\"navigationBarList\">\r\n                    <Link to=\"/\" className=\"navItem\">Handsontable</Link>\r\n                    <Link to=\"/spread-js\" className=\"navItem\">Spread JS</Link>\r\n                    <Link to=\"/zing-grid\" className=\"navItem\">Zing Grid</Link>\r\n                    <Link to=\"/wijmo-grid\" className=\"navItem\">Wijmo Grid</Link>\r\n                </nav>\r\n\r\n                <div className=\"features\">\r\n                    <Switch>\r\n                        <Route exact path=\"/\">\r\n                            <h4>Handsontable</h4>\r\n                            <p className=\"features-content\">\r\n                                Supports most of the features. Customizable, open-source, good support community, and not bad DOCs.\r\n                                Bad performance.\r\n                            </p>\r\n\r\n                            <ul className=\"features-list\">\r\n                                <li>Copy paste subtable from excel <span className=\"text-green\">+</span></li>\r\n                                <li>Nested rows <span className=\"text-green\">+</span></li>\r\n                                <li>Fixed columns rows <span className=\"text-green\">+</span></li>\r\n                                <li>Remember collapse expand state <span className=\"text-red\">-</span></li>\r\n                                <li>Styling, Read only <span className=\"text-green\">+</span></li>\r\n                                <li>Placeholders <span className=\"text-green\">+</span></li>\r\n                                <li>Tool tips <span className=\"text-green\">+</span></li>\r\n                                <li>PDF export <span className=\"text-blue\">?</span></li>\r\n                                <li>Excel export <span className=\"text-red\">-</span></li>\r\n                                <li>Filtering (eg. for user search, partial sums, pdf export) <span className=\"text-green\">+</span></li>\r\n                                <li>Rotated cells <span className=\"text-green\">+</span></li>\r\n                                <li>Spanned cells <span className=\"text-green\">+</span></li>\r\n                                <li>Validation <span className=\"text-green\">+</span></li>\r\n                                <li>Sums (light weight formulas) <span className=\"text-green\">+</span></li>\r\n                                <li>Sub table selection <span className=\"text-green\">+</span></li>\r\n                                <li>Customisable context menus <span className=\"text-green\">+</span></li>\r\n                                <li>Moving one ore several rows <span className=\"text-green\">+</span></li>\r\n                                <li>Copy cut delete operations <span className=\"text-green\">+</span></li>\r\n                            </ul>\r\n                        </Route>\r\n                        <Route path=\"/spread-js\">\r\n                            <h4>SpreadJS</h4>\r\n                            <p className=\"features-content\">\r\n                                Many features need to be created from scratch. It is Excel in WEB and it works like real excel. Formulas work very well and fast. No need to change DataLayer from Handsontable. Good performance, wide API.\r\n                            </p>\r\n\r\n                            <ul className=\"features-list\">\r\n                                <li>Copy paste subtable from excel <span className=\"text-green\">+</span></li>\r\n                                <li>Nested rows <span className=\"text-green\">+</span></li>\r\n                                <li>Fixed columns rows <span className=\"text-green\">+</span></li>\r\n                                <li>Remember collapse expand state <span className=\"text-blue\">?</span></li>\r\n                                <li>Styling, Read only <span className=\"text-green\">+</span></li>\r\n                                <li>Placeholders <span className=\"text-red\">-</span></li>\r\n                                <li>Tool tips <span className=\"text-blue\">?</span></li>\r\n                                <li>PDF export <span className=\"text-blue\">?</span></li>\r\n                                <li>Excel export <span className=\"text-green\">+</span></li>\r\n                                <li>Filtering (eg. for user search, partial sums, pdf export) <span className=\"text-green\">+</span></li>\r\n                                <li>Rotated cells <span className=\"text-blue\">?</span></li>\r\n                                <li>Spanned cells <span className=\"text-green\">+</span></li>\r\n                                <li>Validation <span className=\"text-green\">+</span></li>\r\n                                <li>Sums (light weight formulas) <span className=\"text-green\">+</span></li>\r\n                                <li>Sub table selection <span className=\"text-green\">+</span></li>\r\n                                <li>Customisable context menus <span className=\"text-green\">+</span></li>\r\n                                <li>Moving one ore several rows <span className=\"text-green\">+</span></li>\r\n                                <li>Copy cut delete operations <span className=\"text-green\">+</span></li>\r\n                            </ul>\r\n                        </Route>\r\n                        <Route path=\"/zing-grid\">\r\n                            <h4>ZingGrid</h4>\r\n\r\n                            <ul className=\"features-list\">\r\n                                <li>Copy paste subtable from excel <span className=\"text-red\">-</span></li>\r\n                                <li>Nested rows <span className=\"text-red\">-</span></li>\r\n                                <li>Fixed columns rows <span className=\"text-red\">-</span></li>\r\n                                <li>Remember collapse expand state <span className=\"text-blue\">?</span></li>\r\n                                <li>Styling, Read only <span className=\"text-green\">+</span></li>\r\n                                <li>Placeholders <span className=\"text-green\">+</span></li>\r\n                                <li>Tool tips <span className=\"text-blue\">?</span></li>\r\n                                <li>PDF export <span className=\"text-blue\">?</span></li>\r\n                                <li>Excel export <span className=\"text-green\">+</span></li>\r\n                                <li>Filtering (eg. for user search, partial sums, pdf export) <span className=\"text-green\">+</span></li>\r\n                                <li>Rotated cells <span className=\"text-blue\">?</span></li>\r\n                                <li>Spanned cells <span className=\"text-green\">+</span></li>\r\n                                <li>Validation <span className=\"text-red\">-</span></li>\r\n                                <li>Sums (light weight formulas) <span className=\"text-red\">-</span></li>\r\n                                <li>Sub table selection <span className=\"text-green\">+</span></li>\r\n                                <li>Customisable context menus <span className=\"text-green\">+</span></li>\r\n                                <li>Moving one ore several rows <span className=\"text-green\">+</span></li>\r\n                                <li>Copy cut delete operations <span className=\"text-red\">-</span></li>\r\n                            </ul>\r\n                        </Route>\r\n                    </Switch>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default NavBar\r\n","import data from './data.json';\r\n\r\nclass DataService {\r\n    constructor() {\r\n        this.data = data;\r\n    }\r\n\r\n    getPhases() {\r\n        return this.data.Phases\r\n    }\r\n\r\n    getCosts() {\r\n        return this.data.Costs\r\n    }\r\n}\r\n\r\nexport default new DataService()\r\n","export default function (fn) {\r\n    const ts = performance.now()\r\n    try {\r\n        fn()\r\n    } catch (err) {\r\n        console.log(err)\r\n    }\r\n    const te = performance.now()\r\n\r\n    return (te - ts).toFixed(2)\r\n}\r\n","import React, { Component, createRef, Fragment } from 'react';\r\nimport dataService from '../db/dataService'\r\nimport Handsontable from 'handsontable'\r\nimport performance from '../helpers/perfomance'\r\nimport 'handsontable/dist/handsontable.full.css';\r\nimport './handsotable.css'\r\n\r\nclass SpreadSheetsCon extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.tableRef = createRef()\r\n        this.state = {\r\n            time: 0\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        const time = performance(this.initTable)\r\n        this.setState({ time })\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.querySelector('#hot-display-license-info').remove()\r\n    }\r\n\r\n    initTable = () => {\r\n        this.hot = new Handsontable(this.tableRef.current, {\r\n            data: dataService.getPhases(),\r\n            nestedRows: true,\r\n            colHeaders: true,\r\n            rowHeaders: true,\r\n            autoRowSize: true,\r\n            stretchH: \"all\",\r\n            height: '500px',\r\n            width: '100%',\r\n            persistentState: true,\r\n            nestedHeaders: [\r\n                [\r\n                    {\r\n                        label: 'Identification',\r\n                        colspan: 2\r\n                    },\r\n                    {\r\n                        label: 'Duration [h]',\r\n                        colspan: 7\r\n                    },\r\n                    {\r\n                        label: 'End Depth [mMD]',\r\n                        colspan: 2\r\n                    },\r\n                    {\r\n                        label: 'Timing',\r\n                        colspan: 3\r\n                    },\r\n                    {\r\n                        label: 'Annotation',\r\n                        colspan: 2\r\n                    }\r\n                ],\r\n                [\r\n                    'Code',\r\n                    'Name',\r\n                    'AFE',\r\n                    'Target',\r\n                    'DSV',\r\n                    'Actual',\r\n                    'NPT',\r\n                    'WOW',\r\n                    'TFT',\r\n                    'Planned',\r\n                    'Actual',\r\n                    'Start',\r\n                    'End',\r\n                    'Days -ahead/+behind',\r\n                    'Contractor',\r\n                    'Comment'\r\n                ]\r\n            ],\r\n            columns: [\r\n                { data: 'code' },\r\n                { data: 'name' },\r\n                {\r\n                    data: 'afeHours',\r\n                    type: 'numeric',\r\n                    numericFormat: {\r\n                        pattern: '0,0.00'\r\n                    },\r\n                    allowEmpty: true,\r\n                    width: 80\r\n                },\r\n                {\r\n                    data: 'targetHours',\r\n                    type: 'numeric',\r\n                    numericFormat: {\r\n                        pattern: '0,0.00'\r\n                    },\r\n                    allowEmpty: true,\r\n                    width: 80\r\n                },\r\n                {\r\n                    data: 'dsvHours',\r\n                    type: 'numeric',\r\n                    numericFormat: {\r\n                        pattern: '0,0.00'\r\n                    },\r\n                    allowEmpty: true,\r\n                    width: 80\r\n                },\r\n                {\r\n                    data: 'actualHours',\r\n                    type: 'numeric',\r\n                    numericFormat: {\r\n                        pattern: '0,0.00'\r\n                    },\r\n                    allowEmpty: true,\r\n                    width: 80\r\n                },\r\n                {\r\n                    data: 'nptHours',\r\n                    type: 'numeric',\r\n                    numericFormat: {\r\n                        pattern: '0,0.00'\r\n                    },\r\n                    allowEmpty: true,\r\n                    width: 80\r\n                },\r\n                {\r\n                    data: 'wowHours',\r\n                    type: 'numeric',\r\n                    numericFormat: {\r\n                        pattern: '0,0.00'\r\n                    },\r\n                    allowEmpty: true,\r\n                    width: 80\r\n                },\r\n                {\r\n                    data: 'tftHours',\r\n                    type: 'numeric',\r\n                    numericFormat: {\r\n                        pattern: '0,0.00'\r\n                    },\r\n                    allowEmpty: true,\r\n                    width: 80\r\n                },\r\n                {\r\n                    data: 'plannedDepth',\r\n                    type: 'numeric',\r\n                    numericFormat: {\r\n                        pattern: '0,0.00'\r\n                    },\r\n                    allowEmpty: true,\r\n                    width: 80\r\n                },\r\n                {\r\n                    data: 'actualDepth',\r\n                    type: 'numeric',\r\n                    numericFormat: {\r\n                        pattern: '0,0.00'\r\n                    },\r\n                    allowEmpty: true,\r\n                    width: 80\r\n                },\r\n                {\r\n                    data: 'start',\r\n                    type: 'date',\r\n                    correctFormat: true,\r\n                    allowEmpty: true\r\n                },\r\n                {\r\n                    data: 'end',\r\n                    type: 'date',\r\n                    correctFormat: true,\r\n                    allowEmpty: true\r\n                },\r\n                {\r\n                    data: 'behindHours',\r\n                    type: 'numeric',\r\n                    allowEmpty: true,\r\n                    width: 80\r\n                },\r\n                {\r\n                    data: 'contractor',\r\n                    type: 'numeric',\r\n                    allowEmpty: true,\r\n                    width: 80\r\n                },\r\n                { data: 'comments' }\r\n\r\n            ],\r\n            contextMenu: true,\r\n            bindRowsWithHeaders: 'strict',\r\n            manualRowMove: true\r\n        })\r\n\r\n        this.hot.updateSettings({\r\n            cells(row, col, prop) {\r\n                const cellProperties = this;\r\n                const classes = [];\r\n                let readOnly = false;\r\n\r\n                const isTotal = this.instance.getDataAtRowProp(this.visualRow, 'isTotal');\r\n                const isGroup = this.instance.getDataAtRowProp(this.visualRow, 'group');\r\n\r\n                if (isGroup) {\r\n                    readOnly = true;\r\n                    // add style for group rows\r\n                    classes.push('group-cell');\r\n                } else if (isTotal) {\r\n                    readOnly = true;\r\n                    // add style for total row\r\n                    classes.push('total-cell');\r\n                } else {\r\n                    classes.push('leaf-cell');\r\n                }\r\n\r\n                if (readOnly) {\r\n                    classes.push('locked-cell');\r\n                }\r\n\r\n                // Lock date styles\r\n                if (!isTotal) {\r\n                    const start = this.instance.getDataAtRowProp(this.visualRow, 'start');\r\n                    const overriddenStart = this.instance.getDataAtRowProp(this.visualRow, 'overriddenStart');\r\n                    const lockTimestamp = +new Date();\r\n\r\n                    if (+new Date(start) < lockTimestamp || +new Date(overriddenStart) < lockTimestamp) {\r\n                        // readOnly = true;\r\n                        classes.push('parked-cell');\r\n                    }\r\n                }\r\n\r\n                cellProperties.readOnly = readOnly;\r\n                cellProperties.className = classes.join(' ')\r\n                return cellProperties;\r\n            }\r\n        });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <Fragment>\r\n                <h3>Handsontable render performance: <span style={{ color: 'tomato' }}>{this.state.time}ms</span></h3>\r\n\r\n                <div ref={this.tableRef}\r\n                     style={{ overflow: 'hidden', flex: '1 1 auto', fontSize: '11px' }}\r\n                />\r\n            </Fragment>\r\n        )\r\n    }\r\n}\r\n\r\nexport default SpreadSheetsCon\r\n","function createFlatter() {\r\n    let globalIndex = -1\r\n\r\n    return function flatData(data, newData = [], groups = []) {\r\n        data.forEach(row => {\r\n            newData.push(row)\r\n            globalIndex++\r\n\r\n            if (row.__children) {\r\n                groups.push({\r\n                    index: globalIndex,\r\n                    count: row.__children.length\r\n                })\r\n                flatData(row.__children, newData, groups)\r\n                delete row.__children\r\n            }\r\n        })\r\n\r\n        return { data: newData, groups }\r\n    }\r\n}\r\n\r\n\r\nexport default createFlatter\r\n","import React, { Component, createRef, Fragment } from 'react';\r\nimport dataService from '../db/dataService'\r\nimport performance from '../helpers/perfomance'\r\nimport createFlatter from '../helpers/flat-data'\r\nimport '@grapecity/spread-sheets/styles/gc.spread.sheets.excel2013white.css';\r\n\r\nconst GC = window.GC\r\n\r\nfunction columnToLetter(column) {\r\n    let temp, letter = '';\r\n    while (column > 0) {\r\n        temp = (column - 1) % 26;\r\n        letter = String.fromCharCode(temp + 65) + letter;\r\n        column = (column - temp - 1) / 26;\r\n    }\r\n    return letter;\r\n}\r\n\r\nexport default class SpreadJS extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n\r\n        this.tableRef = createRef()\r\n        this.state = {\r\n            time: 0\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        setTimeout(() => {\r\n            const time = performance(this.initSpread)\r\n            this.setState({ time })\r\n        })\r\n    }\r\n\r\n    initSpread = () => {\r\n        const spread = new GC.Spread.Sheets.Workbook(this.tableRef.current, { sheetCount: 1 });\r\n        spread.options.tabStripVisible = false\r\n        spread.options.tabNavigationVisible = false\r\n        spread.options.tabEditable = true\r\n        spread.options.newTabVisible = false\r\n        const sheet = spread.getActiveSheet()\r\n        const spreadNS = GC.Spread.Sheets;\r\n\r\n        sheet.suspendPaint()\r\n        const flatData = createFlatter()\r\n        const { data, groups } = flatData(dataService.getPhases())\r\n\r\n        sheet.options.isProtected = true\r\n        sheet.autoGenerateColumns = false\r\n        sheet.setDataSource(data)\r\n\r\n        sheet.setRowCount(2, spreadNS.SheetArea.colHeader);\r\n\r\n        sheet.addSpan(0, 0, 1, 2, spreadNS.SheetArea.colHeader);\r\n        sheet.setValue(0, 0, \"Identification\", spreadNS.SheetArea.colHeader);\r\n\r\n        sheet.addSpan(0, 2, 1, 6, spreadNS.SheetArea.colHeader);\r\n        sheet.setValue(0, 2, \"Duration\", spreadNS.SheetArea.colHeader);\r\n\r\n        sheet.addSpan(0, 8, 1, 2, spreadNS.SheetArea.colHeader);\r\n        sheet.setValue(0, 8, \"End Depth\", spreadNS.SheetArea.colHeader);\r\n\r\n        sheet.addSpan(0, 10, 1, 3, spreadNS.SheetArea.colHeader);\r\n        sheet.setValue(0, 10, \"Timing\", spreadNS.SheetArea.colHeader);\r\n\r\n        sheet.addSpan(0, 13, 1, 2, spreadNS.SheetArea.colHeader);\r\n        sheet.setValue(0, 13, \"Annotation\", spreadNS.SheetArea.colHeader);\r\n\r\n        // columns\r\n        sheet.bindColumn(0, { name: 'code', displayName: 'Code' })\r\n        sheet.bindColumn(1, { name: 'name', displayName: 'Name' })\r\n        sheet.bindColumn(2, { name: 'afeHours', displayName: 'AFE', formatter: '0.00', size: 80 })\r\n        sheet.bindColumn(3, { name: 'targetHours', displayName: 'Target', formatter: '0.00', size: 80 })\r\n        sheet.bindColumn(4, { name: 'dsvHours', displayName: 'DSV', formatter: '0.00', size: 80 })\r\n        sheet.bindColumn(5, { name: 'actualHours', displayName: 'Actual', formatter: '0.00', size: 80 })\r\n        sheet.bindColumn(6, { name: 'nptHours', displayName: 'NPT', formatter: '0.00', size: 80 })\r\n        sheet.bindColumn(7, { name: 'tftHours', displayName: 'TFT', formatter: '0.00', size: 80 })\r\n        sheet.bindColumn(8, { name: 'plannedDepth', displayName: 'Planned', formatter: '0.00', size: 80 })\r\n        sheet.bindColumn(9, { name: 'actualDepth', displayName: 'Actual', formatter: '0.00', size: 80 })\r\n        sheet.bindColumn(10, { name: 'start', displayName: 'Start', formatter: 'DD-MM-yyyy HH:mm' })\r\n        sheet.bindColumn(11, { name: 'end', displayName: 'End', formatter: 'DD-MM-yyyy HH:mm' })\r\n        sheet.bindColumn(12, { name: 'behindHours', displayName: 'Behind hours', formatter: '0.00', size: 100 })\r\n        sheet.bindColumn(13, { name: 'contractor', displayName: 'Contractor', size: 200 })\r\n        sheet.bindColumn(14, { name: 'comments', displayName: 'Comment', size: 200 })\r\n        sheet.setColumnCount(15)\r\n\r\n        const style = new spreadNS.Style()\r\n        style.backColor = '#f6f6f6'\r\n        style.cellPadding = '0 2'\r\n\r\n        // Total row\r\n        const totalRow = sheet.getRowCount()\r\n        sheet.addRows(sheet.getRowCount(spreadNS.SheetArea.viewport), 1)\r\n        sheet.setStyle(totalRow, 1, style, spreadNS.SheetArea.viewport)\r\n        sheet.setValue(totalRow, 1, 'Total')\r\n\r\n        const columnsCount = sheet.getColumnCount()\r\n        const groupsIndex = groups.map(({ index }) => index + 1)\r\n\r\n        function createTotal(letter) {\r\n            return `${letter}${groupsIndex.join(`,${letter}`)}`\r\n        }\r\n\r\n        groups.forEach(({ index, count }) => {\r\n            let i = columnsCount\r\n            while (i >= 0) {\r\n                sheet.setStyle(index, i, style, spreadNS.SheetArea.viewport)\r\n                const cell = sheet.getCell(index, i, spreadNS.SheetArea.viewport)\r\n                cell\r\n                    .borderLeft(new spreadNS.LineBorder(\"#ccc\", spreadNS.LineStyle.thin))\r\n                    .borderRight(new spreadNS.LineBorder(\"#ccc\", spreadNS.LineStyle.thin))\r\n                    .borderTop(new spreadNS.LineBorder(\"#ccc\", spreadNS.LineStyle.thin))\r\n                    .borderBottom(new spreadNS.LineBorder(\"#ccc\", spreadNS.LineStyle.thin))\r\n\r\n                if (i > 1 && i < 8) {\r\n                    const columnLetter = columnToLetter(i + 1)\r\n                    const startRow = index + 2\r\n                    const endRow = index + count + 1\r\n                    const sumFormula = `=SUM(${columnLetter}${startRow}:${columnLetter}${endRow})`\r\n                    sheet.setFormula(index, i, sumFormula)\r\n                    sheet.setFormula(totalRow, i, `=SUM(${createTotal(columnLetter)})`)\r\n                }\r\n                i--\r\n            }\r\n\r\n            // Prevent lock events\r\n            const row = new spreadNS.CellRange(sheet, index + 1, 0, count, columnsCount)\r\n            row.locked(false)\r\n\r\n            // group events to phases\r\n            sheet.rowOutlines.group(index + 1, count)\r\n            sheet.rowOutlines.expand(0, false)\r\n            sheet.rowOutlines.direction(spreadNS.Outlines.OutlineDirection.backward);\r\n        })\r\n\r\n\r\n        // auto fit\r\n        sheet.autoFitColumn(1)\r\n        sheet.autoFitColumn(10)\r\n        sheet.autoFitColumn(11)\r\n        sheet.resumePaint()\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <Fragment>\r\n                <h3>SpreadJS render performance: <span style={{ color: 'tomato' }}>{this.state.time}ms</span></h3>\r\n                <div ref={this.tableRef} style={{ height: '100%', width: '100%' }}/>\r\n            </Fragment>\r\n        )\r\n    }\r\n}\r\n","import React, { Component, Fragment, createRef } from 'react';\r\nimport dataService from '../db/dataService'\r\nimport ZingGrid from 'zinggrid';\r\nimport './zing-grid.css'\r\nimport createFlatter from '../helpers/flat-data'\r\n\r\n\r\nwindow.assignDataToNestedGrid = (index, cellRef, recordRef) => {\r\n    if (cellRef) {\r\n        cellRef.querySelector('zing-grid').setData(JSON.stringify(index))\r\n    }\r\n}\r\nexport default class ZingGridView extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.tabelEl = createRef()\r\n        this.state = {\r\n            time: 0\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.initTable()\r\n    }\r\n\r\n    initTable = () => {\r\n        const ts = window.performance.now()\r\n        const flatData = createFlatter()\r\n        const { data } = flatData(dataService.getPhases())\r\n        const grid = new ZingGrid(this.tabelEl.current, {\r\n            data,\r\n            columns: [\r\n                {\r\n                    index: 'code',\r\n                    width: 80\r\n                },\r\n                {\r\n                    index: 'name'\r\n                },\r\n                {\r\n                    index: 'afeHours',\r\n                    type: 'number',\r\n                    header: 'AFE',\r\n                    width: 80\r\n                },\r\n                {\r\n                    index: 'targetHours',\r\n                    type: 'number',\r\n                    header: 'Target',\r\n                    width: 80\r\n                },\r\n                {\r\n                    index: 'dsvHours',\r\n                    type: 'number',\r\n                    header: 'DSV',\r\n                    width: 80\r\n                },\r\n                {\r\n                    index: 'nptHours',\r\n                    type: 'number',\r\n                    header: 'NPT',\r\n                    width: 80\r\n                },\r\n                {\r\n                    index: 'wowHours',\r\n                    type: 'number',\r\n                    header: 'WOW',\r\n                    width: 80\r\n                },\r\n                {\r\n                    index: 'tftHours',\r\n                    type: 'number',\r\n                    header: 'TFT',\r\n                    width: 80\r\n                },\r\n                {\r\n                    index: 'plannedDepth',\r\n                    type: 'number',\r\n                    header: 'Planned',\r\n                    width: 80\r\n                },\r\n                {\r\n                    index: 'actualDepth',\r\n                    type: 'number',\r\n                    header: 'Actual',\r\n                    width: 80\r\n                }\r\n            ],\r\n            editor: true,\r\n            layout: 'row',\r\n            loading: true,\r\n            height: '600px',\r\n            loadByScroll: true\r\n        });\r\n\r\n        grid.addEventListener('grid:ready', (e) => {\r\n            const te = window.performance.now()\r\n            const time = (te - ts).toFixed(2)\r\n            this.setState({ time })\r\n        })\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <Fragment>\r\n                <h3>Zing grid render performance: <span style={{ color: 'tomato' }}>{this.state.time}ms</span></h3>\r\n                <div ref={this.tabelEl}/>\r\n            </Fragment>\r\n        )\r\n    }\r\n}\r\n","import React, { Component, Fragment, createRef } from 'react';\r\nimport './wijmo.css'\r\nimport '@grapecity/wijmo.styles/wijmo.css';\r\nimport { FlexGrid, FlexGridColumn } from \"@grapecity/wijmo.react.grid\";\r\nimport * as wjCore from '@grapecity/wijmo';\r\nimport { FlexGridXlsxConverter } from '@grapecity/wijmo.grid.xlsx';\r\nimport * as wjGrid from '@grapecity/wijmo.grid';\r\nimport { Menu, MenuItem, MenuSeparator } from '@grapecity/wijmo.react.input';\r\n\r\nimport dataService from '../db/dataService'\r\n\r\nfunction isGroupRow(row) {\r\n    return row instanceof wjGrid.GroupRow\r\n}\r\n\r\nfunction getRowLevel(row) {\r\n    return isGroupRow(row) ? row.level : -1\r\n}\r\n\r\nfunction getParentNode(row) {\r\n    let parentRow = null\r\n    const rowLevel = getRowLevel(row);\r\n    if (rowLevel === -1) return\r\n\r\n    let i = row.index\r\n    do {\r\n        i--\r\n        parentRow = row.grid.rows[i]\r\n    } while (getRowLevel(parentRow) >= rowLevel)\r\n\r\n    return parentRow\r\n}\r\n\r\n\r\nclass CostTableView extends Component {\r\n    gridRef = createRef()\r\n    state = {\r\n        costs: dataService.getCosts(),\r\n        filter: ''\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.updateGridStyles()\r\n\r\n        this.workerGrid.collapseGroupsToLevel(0)\r\n        this.workerGrid.rowAdded.addHandler(() => {\r\n            this.updateGridStyles()\r\n        })\r\n\r\n        this.workerGrid.deletedRow.addHandler((grid, e) => {\r\n            this.updateGridStyles()\r\n        })\r\n\r\n        this.workerGrid.deletingRow.addHandler((grid, e) => {\r\n            // this.updateGridStyles()\r\n        })\r\n    }\r\n\r\n    initTable() {\r\n        const { model } = this.props\r\n        const colHeaders = [\r\n            'Name',\r\n            'Code',\r\n            'Type',\r\n            'Unit',\r\n            'Rate',\r\n            'Currency',\r\n            'Populate <br> Daily'\r\n        ];\r\n        const columns = [\r\n            {\r\n                data: 'name',\r\n                type: 'text',\r\n                width: 320\r\n            },\r\n            {\r\n                data: 'code',\r\n                type: 'text',\r\n                width: 80\r\n            },\r\n            {\r\n                data: 'type',\r\n                type: 'dropdown',\r\n                source: ['tangible', 'intangible', 'consumable'],\r\n                width: 80\r\n            },\r\n            {\r\n                data: 'unit',\r\n                type: 'dropdown',\r\n                source: [],\r\n                width: 80\r\n            },\r\n            {\r\n                data: 'rate',\r\n                type: 'numeric'\r\n            },\r\n            {\r\n                data: 'currency',\r\n                type: 'dropdown',\r\n                source: model.currencies,\r\n                width: 80\r\n            },\r\n            {\r\n                data: 'populateDaily',\r\n                type: 'numeric'\r\n            }\r\n        ];\r\n\r\n        const fixedColumnsLeft = columns.length;\r\n        const lockDate = model.get('LockDate') ? new Date(model.get('LockDate')) : null;\r\n        const priorCol = { data: model.beforeOnhire.key, type: 'numeric', width: 30 };\r\n        const afterOffhireCol = { data: model.afterOffhire.key, type: 'numeric', width: 30 };\r\n\r\n        if (lockDate) {\r\n            priorCol.readOnly = true;\r\n            afterOffhireCol.readOnly = true;\r\n        }\r\n\r\n        const columnsRight = [];\r\n        columnsRight.push(priorCol);\r\n        colHeaders.push(model.beforeOnhire.title);\r\n\r\n        model.eachPhaseDay(({ day, key, phase, serial }) => {\r\n            const date = new Date(day);\r\n            const column = {\r\n                data: key,\r\n                type: 'numeric',\r\n                width: 30,\r\n                readOnly: lockDate >= date,\r\n                renderer(instance, td, row, col, prop, value, cellProperties) {\r\n                    if (!value) {\r\n                        const placeholderKey = key.replace('days', 'populatedDays'); // key like populatedDays.2020-02-02\r\n                        cellProperties.placeholder = instance.getDataAtRowProp(row, placeholderKey);\r\n                    }\r\n                }\r\n            }\r\n            columnsRight.push(column);\r\n            colHeaders.push(day);\r\n        });\r\n\r\n        colHeaders.push(model.afterOffhire.title);\r\n        columnsRight.push(afterOffhireCol);\r\n\r\n        const grid = new FlexGrid(this.tableRef.current, {\r\n            childItemsPath: '__children',\r\n            autoGenerateColumns: false,\r\n            selectionMode: 'Row',\r\n            columns: [\r\n                {\r\n                    binding: 'name',\r\n                    header: 'Name',\r\n                    width: '*'\r\n                },\r\n                {\r\n                    binding: 'code',\r\n                    header: 'Code'\r\n                },\r\n                {\r\n                    binding: 'type',\r\n                    header: 'Type',\r\n                    dataMap: ['tangible', 'intangible', 'consumable']\r\n                },\r\n                {\r\n                    binding: 'unit',\r\n                    header: 'Unit'\r\n                },\r\n                {\r\n                    binding: 'rate',\r\n                    header: 'Rate'\r\n                },\r\n                {\r\n                    binding: 'currency',\r\n                    header: 'Currency'\r\n                },\r\n                {\r\n                    binding: 'populateDaily',\r\n                    header: 'Populate Daily'\r\n                },\r\n                {\r\n                    binding: 'days.2020-05-11',\r\n                    header: '2020-05-11'\r\n                }\r\n            ],\r\n            // allowAddNew: true,\r\n            // allowDelete: true,\r\n            itemsSource: model.get('Costs'),\r\n            loadedRows: function (s, e) {\r\n                console.log(s)\r\n                s.rows.forEach(function (row) {\r\n                    row.isReadOnly = false;\r\n                });\r\n            }\r\n        })\r\n        // const pruneObject = (key, cost) => {\r\n        //     const obj = cost[key]\r\n        //     if (!(obj instanceof Object) || !Object.keys(obj).length) {\r\n        //         delete cost[key]\r\n        //         return\r\n        //     }\r\n        //\r\n        //     Object.entries(obj).forEach(([key1, value]) => {\r\n        //         cost[`${key}_${key1}`] = value\r\n        //     })\r\n        //     delete cost[key]\r\n        // }\r\n        //\r\n        // function createBody(costs) {\r\n        //     return costs.map(cost => {\r\n        //         if (cost.__children) {\r\n        //             cost.Items = createBody(cost.__children)\r\n        //             delete cost.__children\r\n        //         }\r\n        //\r\n        //         ['days', 'populatedDays'].forEach((key) => pruneObject(key, cost))\r\n        //\r\n        //         return cost\r\n        //     })\r\n        // }\r\n    }\r\n\r\n    initialWorkerGrid = (grid) => {\r\n        this.workerGrid = grid;\r\n        // grid.columnFooters.rows.push(new wjGrid.GroupRow());\r\n        // grid.bottomLeftCells.setCellData(0, 0, '');\r\n        grid.formatItem.addHandler((grid, e) => {\r\n            if (e.panel !== grid.cells) {\r\n                return\r\n            }\r\n\r\n            const { row, col } = e\r\n            const rowData = grid.rows[row]\r\n            const colData = grid.columns[col]\r\n            const item = rowData.dataItem\r\n\r\n            // if (colData.binding === 'rate' && rowData.hasChildren) {\r\n            //     e.cell.textContent = wjCore.getAggregate(1, item.__children, 'rate')\r\n            // }\r\n\r\n            if (/days/.test(colData.binding) && !rowData.hasChildren) {\r\n                // e.cell.textContent = get(item, colData.binding, get(item, colData.binding.replace('days', 'populatedDays')))\r\n            }\r\n        });\r\n\r\n        grid.itemFormatter = (panel, r, c, cell) => {\r\n            if (panel.cellType === wjGrid.CellType.ColumnHeader) {\r\n            }\r\n        }\r\n    }\r\n\r\n    onCellEditEnding = (grid, e) => {\r\n        console.log('edited')\r\n    }\r\n\r\n    updateGridStyles = () => {\r\n        this.workerGrid.rows.forEach((row) => {\r\n            if (!row.hasChildren) {\r\n                row.cssClass = 'wj-group--bg-white'\r\n            }\r\n            row.isReadOnly = row.hasChildren;\r\n        });\r\n    }\r\n\r\n    onFilter = ({ target: { value } }) => {\r\n        this.setState(() => {\r\n            const filter = value.toLowerCase()\r\n            const costs = dataService.getCosts()\r\n\r\n            return {\r\n                costs: this.filter(filter, costs),\r\n                filter\r\n            }\r\n        }, () => {\r\n            this.updateGridStyles()\r\n        })\r\n    }\r\n\r\n    filter(filterString, costs) {\r\n        if (filterString === '') return costs;\r\n        const keysToSearch = ['name', 'code'];\r\n\r\n        const search = cost => {\r\n            const values = keysToSearch.map(key => cost[key]).filter(v => v);\r\n            if (values.some(v => v.toLowerCase().includes(filterString))) {\r\n                return cost;\r\n            }\r\n\r\n            if (cost.__children && cost.__children.length) {\r\n                const costCopy = Object.assign({}, cost);\r\n                const children = cost.__children.reduce(collectResults, []);\r\n\r\n                if (children.length) {\r\n                    costCopy.__children = children;\r\n                    return costCopy;\r\n                }\r\n            }\r\n\r\n            return null;\r\n        };\r\n\r\n        function collectResults(acc, cost) {\r\n            const res = search(cost);\r\n            if (res) acc.push(res);\r\n\r\n            return acc;\r\n        }\r\n\r\n        return costs.reduce(collectResults, []);\r\n    }\r\n\r\n    onMenuItemClicked = ({ selectedValue }) => {\r\n        const cmd = this[selectedValue]\r\n        if (typeof cmd !== 'function') {\r\n            console.log('Context Menu: no cmd found ', selectedValue)\r\n            return\r\n        }\r\n\r\n        cmd()\r\n    }\r\n\r\n    addRow = () => {\r\n        const { row: rowIndex } = this.workerGrid.selection\r\n        const { rows } = this.workerGrid\r\n        const rowData = rows[rowIndex].dataItem\r\n\r\n        this.setState(({ costs }) => {\r\n            if (!rowData.__children) {\r\n                rowData.__children = []\r\n            }\r\n\r\n            rowData.__children.push({ name: '', code: '', days: {}, populatedDays: {} })\r\n\r\n            const newCosts = [...costs]\r\n            return { costs: newCosts }\r\n        }, () => {\r\n            this.workerGrid.refresh()\r\n            this.updateGridStyles()\r\n        })\r\n    }\r\n\r\n    removeRow = () => {\r\n        const { row: rowIndex } = this.workerGrid.selection\r\n        const { rows } = this.workerGrid\r\n        const row = rows[rowIndex]\r\n        const parentRow = getParentNode(row)\r\n\r\n        if (parentRow) {\r\n            this.setState(({ costs }) => {\r\n                const parentRowData = parentRow.dataItem\r\n                const rowData = row.dataItem\r\n                const childIndex = parentRowData.__children.findIndex(child => child === rowData)\r\n\r\n                if (childIndex >= 0) {\r\n                    parentRowData.__children.splice(childIndex, 1)\r\n                }\r\n\r\n                return { costs: [...costs] }\r\n            }, () => {\r\n                this.workerGrid.refresh()\r\n                this.updateGridStyles()\r\n            })\r\n        }\r\n    }\r\n\r\n    collapseAll = () => {\r\n        this.workerGrid.collapseGroupsToLevel(0)\r\n    }\r\n\r\n    expandAll = () => {\r\n        this.workerGrid.collapseGroupsToLevel(this.workerGrid.rows.maxGroupLevel + 1)\r\n    }\r\n\r\n\r\n    onDraggedRow = (grid, e) => {\r\n        console.log(e)\r\n    }\r\n\r\n    exportExcel = () => {\r\n        const book = FlexGridXlsxConverter.save(this.workerGrid, {\r\n            includeColumnHeaders: true,\r\n            includeRowHeaders: true\r\n        })\r\n\r\n        book.sheets[0].name = 'FlexGrid Data';\r\n        book.saveAsync('FlexGrid-Export.xlsx');\r\n    }\r\n\r\n    render() {\r\n        const { costs, filter, time } = this.state\r\n        const { model } = this.props\r\n        const columns = ['days.2015-06-22', 'days.2015-06-27', 'days.2015-07-05', 'days.2015-07-11'].map((key) =>\r\n            <FlexGridColumn\r\n                binding={key}\r\n                header={key.replace('days.', '')}\r\n                key={key}\r\n                allowResizing={false}></FlexGridColumn>)\r\n\r\n\r\n        return (\r\n            <div className=\"cost-view\">\r\n                <h3>Wijmo Grid render performance: <span style={{ color: 'tomato' }}>{time}ms</span></h3>\r\n\r\n                <input type=\"text\" value={filter}\r\n                       placeholder=\"Filter\"\r\n                       className=\"form-control\" style={{ marginBottom: '20px' }}\r\n                       onChange={this.onFilter}/>\r\n                <FlexGrid\r\n                    ref={this.gridRef}\r\n                    itemsSource={costs}\r\n                    selectionMode=\"Row\"\r\n                    autoGenerateColumns={false}\r\n                    childItemsPath=\"__children\"\r\n                    frozenColumns={7}\r\n                    isReadOnly={false}\r\n                    allowSorting={false}\r\n                    allowDragging=\"Rows\"\r\n                    allowAddNew={true}\r\n                    // allowDelete={true}\r\n                    initialized={this.initialWorkerGrid}\r\n                    cellEditEnding={this.onCellEditEnding}\r\n                    draggedRow={this.onDraggedRow}\r\n                >\r\n                    <FlexGridColumn binding=\"name\" header=\"Name\" width=\"2*\" minWidth={200}\r\n                                    isReadOnly={false}></FlexGridColumn>\r\n                    <FlexGridColumn binding=\"code\" header=\"Code\"></FlexGridColumn>\r\n                    <FlexGridColumn binding=\"type\" header=\"Type\"\r\n                                    dataMap={['tangible', 'intangible', 'consumable']}></FlexGridColumn>\r\n                    <FlexGridColumn binding=\"unit\" header=\"Unit\"\r\n                                    dataMap={['day rate', 'lump sum', 'unit cost', 'depth based']}></FlexGridColumn>\r\n                    <FlexGridColumn binding=\"rate\" header=\"Rate\"></FlexGridColumn>\r\n                    <FlexGridColumn binding=\"currency\" header=\"Currency\"\r\n                                    dataMap={[\"AUD\", \"EUR\", \"GBP\", \"NOK\", \"USD\"]}></FlexGridColumn>\r\n                    <FlexGridColumn binding=\"populateDaily\" header=\"Populate Daily\" format=\"n*\"></FlexGridColumn>\r\n                    <FlexGridColumn binding=\"prior\" header=\"Before onhire\"></FlexGridColumn>\r\n                    {columns}\r\n                    <FlexGridColumn binding=\"afterOffhire\" header=\"After offhire\"></FlexGridColumn>\r\n                </FlexGrid>\r\n\r\n                <Menu contextMenuOf={this.gridRef}\r\n                      header=\"Context Menu\"\r\n                      selectedValuePath=\"cmd\"\r\n                      dropDownCssClass=\"ctx-menu\"\r\n                      itemClicked={this.onMenuItemClicked}\r\n                >\r\n                    <MenuItem cmd=\"addRow\">\r\n                        Add row\r\n                    </MenuItem>\r\n                    <MenuItem cmd=\"removeRow\">\r\n                        Remove row\r\n                    </MenuItem>\r\n                    <MenuSeparator></MenuSeparator>\r\n                    <MenuItem cmd=\"collapseAll\">\r\n                        Collapse all\r\n                    </MenuItem>\r\n                    <MenuItem cmd=\"expandAll\">Expand all</MenuItem>\r\n                    <MenuSeparator></MenuSeparator>\r\n                    <MenuItem cmd=\"exportExcel\">Export Excel</MenuItem>\r\n                </Menu>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default CostTableView\r\n","import React, { Component } from 'react';\r\nimport './App.css'\r\nimport NavBar from './components/NavBar'\r\nimport Handsontable from './views/Handsontable'\r\nimport SpreadJS from './views/SpreadJS'\r\nimport ZingGrid from './views/ZingGrid'\r\nimport WijmoGrid from './views/WijmoGrid'\r\nimport { HashRouter, Route, Switch } from 'react-router-dom'\r\n\r\n\r\nclass Sample extends Component {\r\n    render() {\r\n        return (\r\n            <HashRouter>\r\n                <NavBar/>\r\n                <div className=\"views-container\">\r\n                    <Switch>\r\n                        <Route exact path=\"/\">\r\n                            <Handsontable/>\r\n                        </Route>\r\n                        <Route path=\"/spread-js\">\r\n                            <SpreadJS/>\r\n                        </Route>\r\n                        <Route path=\"/zing-grid\">\r\n                            <ZingGrid/>\r\n                        </Route>\r\n                        <Route path=\"/wijmo-grid\">\r\n                            <WijmoGrid/>\r\n                        </Route>\r\n                    </Switch>\r\n                </div>\r\n            </HashRouter>\r\n        )\r\n    }\r\n}\r\n\r\nexport default Sample\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}